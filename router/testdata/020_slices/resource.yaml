Routes:
  - URI: "/api/events"
    Method: GET
    View:
      Ref: events_ref
      Name: events

Resource:
  Views:
    - Name: events_ref
      Connector:
        Ref: db
      Table: events
      Selector:
        Constraints:
          Criteria: true
        CriteriaParam:
          Ref: Filters

  Connectors:
    - Name: db
      Driver: sqlite3
      DSN: "./testdata/db/db.db"

  Parameters:
    - Name: Filters
      In:
        Kind: query
        Name: filters
      Required: true
      Schema:
        DataType: string
      Codec:
        Name: VeltyCriteria
        Schema:
          DataType: filters
        Source: '
          #set($i = 0)
          #set($inclusive = "")
          #foreach($column in $Unsafe.Columns)
            $inclusive
            #set($j = 0)
            ${Safe_Column.Columns[$i].Column} IN (
            #foreach($searchValue in $column.SearchValues)
              #if($j != 0),#end
              ${Safe_Value.Columns[$i].SearchValues[$j]}
            #set($j = $j + 1)
            #end
            )
            #set($i = $i + 1)
            #if($column.Inclusive == true)
            #set($inclusive = "AND")
            #else
            #set($inclusive = "OR")
            #end
          #end
        '
